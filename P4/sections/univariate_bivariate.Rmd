# Univariate and Bivariate Plots
===

Some basic statistics to get started.
```{r, echo=FALSE, results='asis'}
summary.table <- do.call(cbind, lapply(wine, summary))
knitr::kable( t(summary.table), align='c', digits = 3, 
              caption='Basic Statistics')
```

## Wine Quality
The goal is to explore the factors that have strong influences on wine quality. 
Hence, it is nature to look at the distribution of quality first. 

```{r echo=FALSE, fig.cap="Histrogram of Wine Quality"}
wine$quality <- factor(wine$quality, levels=1:8)

ggplot(aes(x=quality), data = wine) +
  geom_bar(aes(fill=quality), color="black", show.legend = FALSE) +
  scale_x_discrete("Quality") +
  scale_y_continuous(name="Counts of Red Wine", expand=c(0,0)) +
  scale_fill_brewer(type="seq", palette = 1) +
  theme_classic() +
  theme(legend.position=c(0.8,0.7), legend.title.align=0)
```

```{r echo=FALSE}
ft = as.data.frame(table(wine$quality))
names(ft)[1] <- "Quality"
knitr::kable( t(ft), format='html', align = 'c', caption="Wine Quality Frequency")
```

Most of the wine in our sample are median quality ones with rating around from 5 to 6. 

Now, let's continue explore other variables in the dataset.
```{r}
# some fast plot funcation. 
basePlot <- ggplot(data = wine) + 
  scale_color_brewer(type="seq", palette=1) +
  scale_fill_brewer(type="seq", palette=1) +
  theme_dark()

makeHisto <- function(var, binwidth) {
  basePlot + 
    scale_y_continuous(expand = c(0,0)) +
    theme(legend.position=c(0.8,0.7), legend.title.align = 0) +
    xlab(var) +
    geom_histogram(aes_string(x=var , fill='quality'), 
                   binwidth=binwidth, color='white')
}

makeDensity <- function(var) {
  basePlot + 
    geom_density(aes_string(x=var, color='quality', group='quality')) +
    scale_y_continuous(expand = c(0,0)) +
    theme(legend.position=c(0.8,0.7), legend.title.align = 0)
}

makeBoxPlot <- function(var) {
  basePlot +
    geom_point(aes_string(y=var, x='quality'), position='jitter', 
               alpha=0.5, shape=4 ) +
    geom_boxplot(aes_string(y=var, x='quality', fill='quality'), 
                 alpha=0.8, show.legend = FALSE) +
    coord_flip()
}
```

### Fix Acidity
```{r, echo=FALSE, fig.cap='Histogram for fix.acidity'}
makeHisto(var='fixed.acidity', 0.1)
```
The fix acidity has a distribution that is slightly skew to the right. 
There are a few outliers with very high value.

```{r, echo=FALSE, fig.cap='Density Distribution for fix.acidity'}
makeDensity(var='fixed.acidity')
```
It looks like higher quality wines tend to have higher fixed acidity, as their 
distribution is further skew to the right when compares to the others.

```{r, echo=FALSE, fig.cap="Boxplots fixed.acidity"}
makeBoxPlot('fixed.acidity')
```

It seems both median and 75% quantile increases as quality increases. However, the highest and lowest quality wine is not exactly consistent with this statement.
```{r}
group = dplyr::group_by(wine, quality)

knitr::kable(
  dplyr::summarise(group, median=median(fixed.acidity), 
                   '75%'=quantile(fixed.acidity, 0.75))
)
```
However, this could be caused by much smaller sample size. As we can see the variance of both are much large than the rest.

### Volatile Acidity
```{r, echo=FALSE, fig.cap='Histogram for Volatile Acidity'}
makeHisto('volatile.acidity', 0.01)
```
The distribution of volatile acidity has a bimodal distribution, with the first modal around 0.4 and the second around 0.6. And from the density plot, we can see the second modal is largely contributed by wines with rating 5. 

```{r, echo=FALSE, fig.cap='Density Distribution for Volatile Acidity'}
makeDensity('volatile.acidity')
```
It is quite clear that higher quality wine tends to have lower volatile acidity.

## Volatile Acid vs. Fixed Acid
I wonder if there is any connect between Volatile and Fixed acid. And it seems they are both have some relationship with quality.

```{r, echo=FALSE, fig.cap="Volative Acid vs Fixed Accid"}
ggplot(aes(x=volatile.acidity, y=fixed.acidity, color=quality), data=wine) +
  scale_color_brewer(type = 'div') +
  geom_point(size=0.75, alpha=0.7) + 
  theme_dark() +
  theme(legend.position=c(0.9,0.7), legend.title.align = 0)
```
I failed to see any interesting pattern between fixed acidity and volatile acidity, 
However we can definitely see a divergance between the high and low quality wine.

##Citric Acid
```{r, echo=FALSE, fig.cap='Histogram for Citric Acid'}
makeHisto('citric.acid', 0.01)
```
There are a lot of wine that doesn't have any citric acid at all. Other than the 
spike just under 0.5, the distribution appears to be quite uniform until 0.5, 
where it started to fade off.

```{r, echo=FALSE, fig.cap='Histogram for Citric Acid'}
makeDensity('citric.acid')
```

```{r, echo=FALSE, fig.cap='Histogram for Citric Acid'}
makeBoxPlot('citric.acid')
```

Both the density distribution and boxplots all suggests the positive relationship
between the citric acid and quality. 

<h3>Residual Suger</h3>
```{r, echo=FALSE, fig.cap='Histogram for Residual Suger'}
makeHisto('residual.sugar', binwidth = 0.1)
```
```{r, echo=FALSE, fig.cap='Distribution of Residual Suger By Quality Rating'}
makeDensity('residual.sugar')
```
There isn't much going here. The distributions looks normal. Maybe a little long 
tail with a few outliers.

```{r, echo=FALSE, fig.cap='Quanlity vs Redisual Sugar (limit from 1 to 4)'}
p1 <- makeBoxPlot('residual.sugar')
p2 <- makeBoxPlot('residual.sugar') + ylim(1, 3.5)
gridExtra::grid.arrange(p1, p2)
```
I made two boxplot this time. the second one is created for residual.sugar 
smaller than 3.5. The majority of wine have residual sugar 1.5 o 2.5.

It is somewhat surprising to me that I don't see any relationship between residual sugar and quality here, as I would personally prefer a bit sweeter taste. 

## Chlorides
```{r, echo=FALSE, fig.cap='Histogram for Chlorides'}
makeHisto('chlorides', 0.005)
```
Again very standard distribution. But outliers might have caused some problem. Let me try to discard those above 0.2 and see what happens.

```{r, echo=FALSE, fig.cap="Histogram for Chlorides (<0.2)"}
ggplot(aes(x=chlorides, fill=quality), data=wine[wine$chlorides < 0.2,])  +
  scale_y_continuous(expand = c(0,0)) +
  scale_fill_brewer(type='seq') +
  theme_dark() +
  theme(legend.position=c(0.8,0.7), legend.title.align = 0) +
  geom_histogram(binwidth=0.001, color='white') + 
  xlab('chlorides')
```

It still looks normally distributed.

```{r, echo=FALSE, fig.cap='Density for Chlorides'}
makeDensity('chlorides')
```
Looks like the lowest quality wine has the largest variance in chlorides content. 
The distribution for other levels of quality looks almost identical. 

```{r, echo=FALSE, fig.cap='Quality vs Chlorides'}
p1 <- makeBoxPlot('chlorides')
p2 <- makeBoxPlot('chlorides') + ylim(0, 0.2)
gridExtra::grid.arrange(p1, p2)
```
Similar to residual sugar, there are a few outliers with large chlorides amount
in our sample. I generated a second boxplot with 0.2 as the cutoff point.

We can see the median value for chlorides decreased as the quality improves.

## Free Sulfur Dioxide
```{r, echo=FALSE, fig.cap='Histogram for free.sulfur.dioxide'}
makeHisto('free.sulfur.dioxide', 1)
```
The distribution is not normal, more like a chi-square.

```{r, echo=FALSE, fig.cap='Density Distributions for free.sulfur.dioxide'}
makeDensity('free.sulfur.dioxide')
```
Not much can be say about this graph. Things are not very obvious.

```{r echo=FALSE, fig.cap='Boxplots free.sulfur.dioxide'}
makeBoxPlot('free.sulfur.dioxide')
```
Similar to the previous one, very hard to really say anything about it. Things are not very obvious.


## Alcohol
```{r, echo=FALSE, fig.cap='Histogram for alcohol'}
makeHisto('alcohol', 0.1)
```
This one also looks like chi-square, definitely not normal. I can already see that the higher quality wine (darker fill) are clustering to the right.

```{r, echo=FALSE, fig.cap='Histogram for alcohol'}
makeDensity('alcohol')
```
Things are even more obvious now. Higher quality wine tends to have higher 
alcohol content.

```{r, echo=FALSE, fig.cap='Quality vs alcohol'}
makeBoxPlot('alcohol')
```
While it is quite clear, that high-quality wine (with a rating of 7 or 8) tends to have higher alcohol content. It is not so clear for the mid-to-low range. On fact, wine with rating 5 has the lowerest alcohol measured by quantiles. 

The correlation between the two is `r cor(wine$alcohol, as.numeric(wine$quality))`